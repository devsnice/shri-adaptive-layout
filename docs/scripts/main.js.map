{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/header/header.js","webpack:///./src/components/videocontrol/audioAnalyse.js","webpack:///./src/components/videocontrol/canvasVideo.js","webpack:///./src/components/videocontrol/player.js","webpack:///./src/components/videocontrol/videocontrol.js","webpack:///./src/components/videocontrol/webglVideo.js","webpack:///./src/components/widget/camera.widget.js","webpack:///./src/components/widget/player.widget.js","webpack:///./src/components/widget/questions.widget.js","webpack:///./src/components/widget/stats.widget.js","webpack:///./src/components/widget/themal.widget.js","webpack:///./src/components/widget/widget.js","webpack:///./src/layout/layout.js","webpack:///./src/pages/index.js","webpack:///./src/pages/index.page.js","webpack:///./src/pages/videocontrol.page.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;AClFA;AAAA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;AChDA;AAAA;;AAEA;;AAEA;AACA,eAAe,yBAAyB;AACxC;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,yDAAyD;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA,mBAAmB,kBAAkB;AACrC;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;;AAEA;;;;;;;;;;;;;AC3DA;AAAA;AACA,eAAe,qBAAqB;AACpC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA,UAAU,6CAA6C;AACvD;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA,QAAQ,4CAA4C,gBAAgB,EAAE;AACtE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;;AAEA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;;;;ACvGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,eAAe;AACf;;AAEA,eAAe,GAAG;AAClB,yDAAyD,GAAG;;AAE5D,eAAe,GAAG;AAClB,yDAAyD,GAAG;;AAE5D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,uCAAuC;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT,OAAO;AACP;;AAEA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,WAAW,kBAAkB;;AAE7B;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB,yCAAyC;AAC/D,sBAAsB,uCAAuC;AAC7D;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACnPiC;;AAEjC;AACA;AACA;AACA;AACA;AACA,eAAe,sCAAsC;AACrD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,8DAA8D,UAAU;;AAExE;;AAEA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;;AAEA;;;;;;;;;;;;;ACtFA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qBAAqB;AACpC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,QAAQ,0BAA0B;AAClC;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA;;;;;;;;;;;;;AC/IA;AAAA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,6E;;;;;;;;;;;;ACVA;AAAA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS,iBAAiB,GAAG,qBAAqB;AAClD;;AAEA;AACA,uDAAuD,iBAAiB;;AAExE;AACA;AACA;;AAEA,6E;;;;;;;;;;;;ACpCA;AAAA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gF;;;;;;;;;;;;ACvBA;AAAA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,4E;;;;;;;;;;;;ACVA;AAAA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS,sBAAsB;AAC/B;;AAEA;AACA;AACA,SAAS,mBAAmB;AAC5B;;AAEA;AACA;AACA;;AAEA,6E;;;;;;;;;;;;;;;;;;AC9BA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,qDAAqD,gBAAgB;;AAErE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,sCAAsC,gBAAgB;;AAEtD;AACA;AACA,6BAA6B,gBAAgB;AAC7C;;AAEA;AACA,WAAW,UAAU,QAAQ;;AAE7B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,6CAA6C,gBAAgB;AAC7D,6CAA6C,gBAAgB;;AAE7D;AACA;AACA;;AAEA;AACA;AACA;;AAEA,uE;;;;;;;;;;;;AC/JA;AAAA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;;;;;;;;;;;;;;;;AClBA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA,sB;;;;;;;;;;;;;;ACnCA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA,0E;;;;;;;;;;;;;;;ACzCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA,iF","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/pages/index.js\");\n","const domUtils = {\n  doesNodeContainClick: (node, e) => {\n    if (!node || !e) return false;\n\n    if (node.contains(e.target)) return true;\n  }\n};\n\nexport default class Navigation {\n  constructor({ selector }) {\n    this.menuOpened = false;\n    this.headerMenu = document.querySelector(selector);\n    this.headerBurgerMenu = document.querySelector(\"#header-burger\");\n\n    if (this.isMobile()) {\n      this.initNavigation();\n    }\n  }\n\n  isMobile() {\n    const maxMobileWidth = 768;\n\n    return window.innerWidth < maxMobileWidth;\n  }\n\n  initNavigation() {\n    this.headerMenu.classList.add(\"header-menu-list_state-mobile\");\n\n    this.headerBurgerMenu.addEventListener(\"click\", () => {\n      if (!this.menuOpened) {\n        this.openNavigation();\n      } else {\n        this.closeNavigation();\n      }\n    });\n  }\n\n  openNavigation() {\n    this.headerMenu.classList.add(\"header-menu-list_state-mobile-opened\");\n\n    this.menuOpened = true;\n  }\n\n  closeNavigation() {\n    this.headerMenu.classList.remove(\"header-menu-list_state-mobile-opened\");\n\n    this.menuOpened = false;\n  }\n}\n","const AudioContext = window.AudioContext || window.webkitAudioContext;\n\nconst context = new AudioContext();\n\nclass Analyse {\n  constructor({ video, noiseLevelRange }) {\n    this.node = context.createScriptProcessor(2048, 1, 1);\n    this.noiseLevelRange = noiseLevelRange;\n\n    this.analyser = context.createAnalyser();\n\n    this.bufferLength = this.analyser.frequencyBinCount;\n    this.bands = new Uint8Array(this.bufferLength);\n\n    this.startShow = false;\n\n    video.addEventListener(\"canplay\", () => {\n      if (!this.source) {\n        this.source = context.createMediaElementSource(video);\n\n        this.source.connect(this.analyser);\n        this.analyser.connect(this.node);\n        this.node.connect(context.destination);\n        this.source.connect(context.destination);\n\n        this.node.onaudioprocess = e => {\n          this.analyser.getByteFrequencyData(this.bands); // copy current data to this.bands\n\n          if (!this.startShow) {\n            this.show();\n            this.startShow = true;\n          }\n        };\n      }\n    });\n  }\n\n  getAverageVolume(array) {\n    let values = 0;\n\n    for (let i = 0; i < array.length; i++) {\n      values += array[i];\n    }\n\n    const average = values / array.length;\n\n    // calculate in 100% scale, 1% is 2.56\n    return average === 0 ? 0 : average / 2.56;\n  }\n\n  show() {\n    requestAnimationFrame(() => {\n      this.noiseLevelRange.value = this.getAverageVolume(this.bands);\n\n      this.show();\n    });\n  }\n}\n\nexport default Analyse;\n","class CanvasVideo {\n  constructor({ video, videoPlayer }) {\n    this.video = video;\n    this.videoPlayer = videoPlayer;\n    this.stopVideo = false;\n\n    this.canvas = null;\n    this.canvasHelper = null;\n  }\n\n  applyBrightness(data, brightness) {\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] += 255 * (brightness / 100);\n      data[i + 1] += 255 * (brightness / 100);\n      data[i + 2] += 255 * (brightness / 100);\n    }\n  }\n\n  applyContrast(data, contrast) {\n    const factor = (259.0 * (contrast + 255.0)) / (255.0 * (259.0 - contrast));\n\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = this.truncateColor(factor * (data[i] - 128.0) + 128.0);\n      data[i + 1] = this.truncateColor(factor * (data[i + 1] - 128.0) + 128.0);\n      data[i + 2] = this.truncateColor(factor * (data[i + 2] - 128.0) + 128.0);\n    }\n  }\n\n  truncateColor(value) {\n    if (value < 0) {\n      value = 0;\n    } else if (value > 255) {\n      value = 255;\n    }\n\n    return value;\n  }\n\n  filter({ video, width, height, contrast, brightness }) {\n    if (!this.canvasHelper) {\n      this.canvasHelper = document.createElement(\"canvas\");\n\n      this.canvasHelper.width = width;\n      this.canvasHelper.height = height;\n    }\n\n    const contextHelper = this.canvasHelper.getContext(\"2d\");\n\n    contextHelper.drawImage(video, 0, 0, width, height);\n\n    const idata = contextHelper.getImageData(0, 0, width, height);\n\n    var data = idata.data;\n\n    this.applyBrightness(data, brightness);\n    this.applyContrast(data, contrast);\n\n    return idata;\n  }\n\n  play({ canvasInited, brightness, contrast, size: { width, height } }) {\n    if (!canvasInited) {\n      this.canvas = document.createElement(\"canvas\");\n\n      this.canvas.style.width = width;\n      this.canvas.style.height = height;\n\n      this.canvas.width = width;\n      this.canvas.height = height;\n\n      this.videoPlayer.appendChild(this.canvas);\n    } else {\n      this.stopVideo = true;\n    }\n\n    const context = this.canvas.getContext(\"2d\");\n\n    const draw = () => {\n      requestAnimationFrame(() => {\n        const filteredImage = this.filter({\n          video: this.video,\n          width,\n          height,\n          contrast,\n          brightness\n        });\n\n        context.putImageData(filteredImage, 0, 0);\n\n        if (this.stopVideo || this.video.paused || this.video.ended) {\n          this.stopVideo = false;\n\n          return false;\n        } else {\n          draw();\n        }\n      });\n    };\n\n    draw();\n  }\n}\n\nexport default CanvasVideo;\n","import WebglVideo from \"./webglVideo\";\nimport CanvasVideo from \"./canvasVideo\";\nimport Analyse from \"./audioAnalyse\";\n\n/**\n * PlayerTemplate - generate video-player from <template> tag\n */\nexport class PlayerTemplate {\n  constructor() {\n    this.template = document.getElementById(\"template-player\");\n  }\n\n  render(id) {\n    const element = this.template.content\n      .querySelector(\".videocontrol-list__item\")\n      .cloneNode(true);\n\n    // player-{id}\n    element.querySelector(\".vc-player\").setAttribute(\"id\", id);\n\n    // player-{id}-video\n    element.querySelector(\"video\").setAttribute(\"id\", `${id}-video`);\n\n    // player-{id}-webgl-video\n    element.querySelector(\"input\").setAttribute(\"id\", `${id}-webgl-video`);\n\n    return element;\n  }\n}\n\n/**\n * Player is a wrapper around html5 video element and HLS standart,\n * it has special behavior for our application.\n */\nexport class Player {\n  constructor({ url, containerElement, playerElement }) {\n    this.settings = {\n      url,\n      webglInited: false,\n      canvasInited: false,\n      containerBounds: null\n    };\n\n    this.videoSettings = {\n      brightness: 0,\n      contrast: 0,\n      isFullscreen: false\n    };\n\n    this.containerElement = containerElement;\n    this.player = playerElement;\n    this.video = playerElement.querySelector(\"video\");\n    this.brightnessRange = playerElement.querySelector(\n      \".vc-player__brightness\"\n    );\n    this.noiseLevelRange = playerElement.querySelector(\n      \".vc-player__noise-level\"\n    );\n    this.contrastRange = playerElement.querySelector(\".vc-player__contrast\");\n\n    this.webglVideo = new WebglVideo({\n      video: this.video,\n      videoPlayer: this.player\n    });\n\n    this.canvasVideo = new CanvasVideo({\n      video: this.video,\n      videoPlayer: this.player\n    });\n\n    this.initPromise = null;\n\n    this.init();\n    this.initEvents();\n  }\n\n  setContainerBounds() {\n    if (!this.settings.containerBounds) {\n      this.settings.containerBounds = this.containerElement.getBoundingClientRect();\n    }\n\n    return this.settings.containerBounds;\n  }\n\n  init() {\n    if (this.initPromise) {\n      return this.initPromise;\n    }\n\n    this.initPromise = new Promise((resolve, reject) => {\n      if (Hls.isSupported()) {\n        const hls = new Hls();\n\n        hls.loadSource(this.settings.url);\n        hls.attachMedia(this.video);\n\n        hls.on(Hls.Events.MANIFEST_PARSED, () => {\n          resolve(this.video);\n        });\n      } else if (this.video.canPlayType(\"application/vnd.apple.mpegurl\")) {\n        this.video.src = this.settings.url;\n\n        this.video.addEventListener(\"loadedmetadata\", () => {\n          resolve(this.video);\n        });\n      }\n    });\n  }\n\n  play() {\n    this.video.play();\n  }\n\n  stop() {\n    this.video.pause();\n  }\n\n  openFullscreen() {\n    if (this.settings.isFullscreen) return false;\n\n    this.setContainerBounds();\n\n    const { containerBounds } = this.settings;\n\n    this.video.muted = false;\n\n    const playerBounds = this.player.getBoundingClientRect();\n\n    this.player.style.transform = `\n        translateX(0px)\n        translateY(0px)\n    `;\n\n    this.player.style.width = playerBounds.width + \"px\";\n    this.player.style.height = playerBounds.height + \"px\";\n    this.player.style.transitionProperty = \"\";\n    this.player.style.transitionDuration = \"\";\n    this.player.style.zIndex = \"2\";\n\n    window.requestAnimationFrame(() => {\n      this.player.style.transitionProperty = \"transform, width, height\";\n      this.player.style.transitionDuration = \"0.3s\";\n\n      // move element to top/left bounder of the list-container\n      this.player.style.transform = `\n        translateX(-${playerBounds.left - containerBounds.left}px)\n        translateY(-${playerBounds.top - containerBounds.top}px)\n      `;\n\n      this.player.style.width = containerBounds.width + \"px\";\n      this.player.style.height = containerBounds.height + \"px\";\n    });\n\n    this.settings.isFullscreen = true;\n  }\n\n  closeFullscreen() {\n    if (!this.settings.isFullscreen) return false;\n\n    this.video.muted = true;\n\n    this.player.style.zIndex = \"1\";\n\n    window.requestAnimationFrame(() => {\n      this.player.style.width = \"100%\";\n      this.player.style.height = \"100%\";\n\n      this.player.style.transform = `\n          translateX(0px)\n          translateY(0px)\n      `;\n    });\n\n    this.settings.isFullscreen = false;\n  }\n\n  playVideoOnWebgl() {\n    this.setContainerBounds();\n\n    if (!this.settings.webglInited) {\n      this.video.classList.add(\"vc-player__video_state-hidden\");\n    }\n\n    this.webglVideo.play({\n      brightness: this.videoSettings.brightness,\n      webglInited: this.settings.webglInited\n    });\n\n    this.settings.webglInited = true;\n  }\n\n  playVideoOnCanvas() {\n    this.setContainerBounds();\n\n    if (!this.settings.canvasInited) {\n      this.video.classList.add(\"vc-player__video_state-hidden\");\n    }\n\n    this.canvasVideo.play({\n      canvasInited: this.settings.canvasInited,\n      size: {\n        width: this.settings.containerBounds.width,\n        height: this.settings.containerBounds.height\n      },\n      brightness: this.videoSettings.brightness,\n      contrast: this.videoSettings.contrast\n    });\n\n    this.settings.canvasInited = true;\n  }\n\n  changeBrightness(value) {\n    this.videoSettings.brightness = value;\n\n    // turn on webgl instead of canvas\n    // this.playVideoOnWebgl();\n    this.playVideoOnCanvas();\n  }\n\n  changeContrast(value) {\n    this.videoSettings.contrast = value;\n\n    this.playVideoOnCanvas();\n  }\n\n  initEvents() {\n    this.brightnessRange.addEventListener(\"change\", e => {\n      this.changeBrightness(e.target.value);\n    });\n\n    this.contrastRange.addEventListener(\"change\", e => {\n      this.changeContrast(e.target.value);\n    });\n\n    this.analyser = new Analyse({\n      video: this.video,\n      noiseLevelRange: this.noiseLevelRange\n    });\n  }\n\n  addEventListener(event, callback) {\n    this.player.addEventListener(event, callback);\n  }\n}\n","import { PlayerTemplate, Player } from \"./player\";\n\n/**\n * Videocontrol represents controller over our feature,\n * it initializes broadcasts and interact with user's actions\n */\nclass Videocontrol {\n  constructor({ broadcasts, elementShowAll, element }) {\n    this.broadcasts = broadcasts;\n    this.element = element;\n    this.elementShowAll = elementShowAll;\n\n    this.state = {\n      fullscreenId: null\n    };\n\n    this.initPlayers();\n    this.initEvents();\n  }\n\n  closeFullPlayer() {\n    // play all players\n    this.broadcasts.forEach(broadcast => broadcast.player.play());\n\n    this.broadcasts[this.state.fullscreenId].player.closeFullscreen();\n\n    this.state.fullscreenId = null;\n  }\n\n  openFullPlayer(id) {\n    // stop all players except a fullscreen\n    this.broadcasts\n      .filter(broadcast => broadcast.id !== id)\n      .forEach(broadcast => broadcast.player.stop());\n\n    // open player in fullscreen\n    this.broadcasts[id].player.openFullscreen();\n\n    this.state.fullscreenId = id;\n  }\n\n  initEvents() {\n    this.elementShowAll.addEventListener(\"click\", () => {\n      this.closeFullPlayer();\n    });\n\n    this.elementShowAll.addEventListener(\"touchend\", () => {\n      this.closeFullPlayer();\n    });\n  }\n\n  initPlayers() {\n    this.broadcasts.forEach((broadcast, index) => {\n      const VideoTemplate = new PlayerTemplate();\n      const listVideoElement = VideoTemplate.render(`player-${index + 1}`);\n\n      this.element.appendChild(listVideoElement);\n\n      const VideoPlayer = new Player({\n        containerElement: this.element,\n        playerElement: listVideoElement.querySelector(\".vc-player\"),\n        url: broadcast.url\n      });\n\n      VideoPlayer.init()\n        .then(() => {\n          VideoPlayer.play();\n\n          // Init events\n          VideoPlayer.addEventListener(\"click\", e => {\n            this.openFullPlayer(index);\n          });\n\n          VideoPlayer.addEventListener(\"touchend\", e => {\n            this.openFullPlayer(index);\n          });\n\n          // Save player to broadcasts array\n          this.broadcasts[index].id = index;\n          this.broadcasts[index].player = VideoPlayer;\n        })\n        .catch(err => console.err(err));\n    });\n  }\n}\n\nexport default Videocontrol;\n","/**\n * It's my test solution of processing video with WebGL\n * https://www.youtube.com/watch?v=_ZQOUQsw_YI - interesting video about webgl\n * and yes, it works, but there's a problem with quality of video\n */\nclass WebglVideo {\n  constructor({ video, videoPlayer }) {\n    this.video = video;\n    this.videoPlayer = videoPlayer;\n    this.stopVideo = false;\n\n    this.canvas = null;\n  }\n\n  calculateBrightness(value) {\n    // от -0.5 до 0.5, 0 - картинка без изменений\n    return (value - 50) / 100;\n  }\n\n  play({ webglInited, brightness }) {\n    if (!webglInited) {\n      this.canvas = document.createElement(\"canvas\");\n\n      this.canvas.style.width = \"auto\";\n      this.canvas.style.height = \"100%\";\n\n      this.videoPlayer.appendChild(this.canvas);\n    } else {\n      this.stopVideo = true;\n    }\n\n    const gl = this.canvas.getContext(\"webgl\");\n\n    // Create new program using gsls\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    gl.clearColor(255, 255, 255, 1.0);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n\n    const vertShaderSource = `\n        attribute vec2 position;\n        varying vec2 texCoords;\n        \n        void main() {\n          texCoords = (position + 1.0) / 2.0;\n          texCoords.y = 1.0 - texCoords.y;\n          gl_Position = vec4(position, 0, 1.0);\n        }\n      `;\n\n    const fragShaderSource = `\n        precision highp float;\n        varying vec2 texCoords;\n        uniform sampler2D textureSampler;\n        \n        void main() {\n          float brightness = ${this.calculateBrightness(brightness)};\n          vec4 color = texture2D(textureSampler, texCoords);\n          color.rgb += brightness;\n          gl_FragColor = color;\n        }\n      `;\n\n    const vertShader = gl.createShader(gl.VERTEX_SHADER);\n    const fragShader = gl.createShader(gl.FRAGMENT_SHADER);\n\n    gl.shaderSource(vertShader, vertShaderSource);\n    gl.shaderSource(fragShader, fragShaderSource);\n\n    gl.compileShader(vertShader);\n    gl.compileShader(fragShader);\n\n    const program = gl.createProgram();\n\n    gl.attachShader(program, vertShader);\n    gl.attachShader(program, fragShader);\n\n    gl.linkProgram(program);\n\n    gl.useProgram(program);\n\n    /** Magic\n     * set rectange\n     */\n    const vertices = new Float32Array([\n      -1,\n      -1,\n      -1,\n      1,\n      1,\n      1,\n      -1,\n      -1,\n      1,\n      1,\n      1,\n      -1\n    ]);\n\n    const vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n\n    const positionLocation = gl.getAttribLocation(program, \"position\");\n\n    gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);\n    gl.enableVertexAttribArray(positionLocation);\n    /** Magic end */\n\n    const draw = () => {\n      requestAnimationFrame(() => {\n        const texture = gl.createTexture();\n\n        gl.activeTexture(gl.TEXTURE0);\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n\n        gl.texImage2D(\n          gl.TEXTURE_2D,\n          0,\n          gl.RGBA,\n          gl.RGBA,\n          gl.UNSIGNED_BYTE,\n          this.video\n        );\n\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\n\n        if (!this.stopVideo) {\n          draw();\n        } else {\n          this.stopVideo = false;\n        }\n      });\n    };\n\n    draw();\n  }\n}\n\nexport default WebglVideo;\n","class CameraWidget {\n  constructor() {\n    this.template = document.getElementById(\"widget-camera-template\");\n  }\n\n  render() {\n    return this.template.content.cloneNode(true);\n  }\n}\n\nexport default CameraWidget;","class PlayerWidget {\n  constructor({ data }) {\n    this.template = document.getElementById(\"widget-player-template\");\n    this.data = data;\n    this.widget = this.template.content.cloneNode(true);\n  }\n\n  setInnerText(selector, text) {\n    const block = this.widget.querySelector(selector);\n\n    if (block) {\n      block.innerText = text;\n    }\n  }\n\n  setCover() {\n    const block = this.widget.querySelector(\".player-now__cover\");\n\n    block.setAttribute(\"src\", this.data.albumcover);\n  }\n\n  render() {\n    this.setCover();\n\n    this.setInnerText(\n      \".player-now__title\",\n      `${this.data.artist} ${this.data.track.name}`\n    );\n\n    this.setInnerText(\".player-progress__time\", this.data.track.length);\n    this.setInnerText(\".player-volume__percentage\", `${this.data.volume}%`);\n\n    return this.widget;\n  }\n}\n\nexport default PlayerWidget;","class QuestionsWidget {\n  constructor({ data }) {\n    this.template = document.getElementById(\"widget-questions-template\");\n    this.data = data;\n    this.widget = this.template.content.cloneNode(true);\n  }\n\n  setInnerText(selector, text) {\n    const block = this.widget.querySelector(selector);\n\n    if (block) {\n      block.innerText = text;\n    }\n  }\n\n  render() {\n    this.setInnerText(\".button_type-yellow\", this.data.buttons[0]);\n    this.setInnerText(\".button_type-grey\", this.data.buttons[1]);\n\n    return this.widget;\n  }\n}\n\nexport default QuestionsWidget;","class StatsWidget {\n  constructor() {\n    this.template = document.getElementById(\"widget-stats-template\");\n  }\n\n  render() {\n    return this.template.content.cloneNode(true);\n  }\n}\n\nexport default StatsWidget;","class ThemalWidget {\n  constructor({ data }) {\n    this.template = document.getElementById(\"widget-thermal-template\");\n    this.data = data;\n    this.widget = this.template.content.cloneNode(true);\n  }\n\n  setInnerText(selector, text) {\n    const block = this.widget.querySelector(selector);\n\n    if (block) {\n      block.innerText = text;\n    }\n  }\n\n  render() {\n    this.setInnerText(\n      \".widget-sensor_type-temp .widget-sensor__value\",\n      `${this.data.temperature}C`\n    );\n\n    this.setInnerText(\n      \".widget-sensor_type-humidity .widget-sensor__value\",\n      `${this.data.humidity}%`\n    );\n\n    return this.widget;\n  }\n}\n\nexport default ThemalWidget;","import StatsWidget from \"./stats.widget\";\nimport CameraWidget from \"./camera.widget\";\nimport QuestionsWidget from \"./questions.widget\";\nimport ThemalWidget from \"./themal.widget\"\nimport PlayerWidget from \"./player.widget\";\n\nconst WIDGET_TYPES = {\n  STATS: \"STATS\",\n  CAMERA: \"CAMERA\",\n  THERMAL: \"THERMAL\",\n  PLAYER: \"PLAYER\",\n  QUESTIONS: \"QUESTIONS\",\n  DEFAULT: \"DEFAULT\"\n};\n\nclass Widget {\n  constructor({ event, container }) {\n    this.event = event;\n    this.container = container;\n    this.template = document.getElementById(\"widget-template\");\n    this.widget = null;\n\n    this.render();\n  }\n\n  setDescription() {\n    if (this.event.description) {\n      this.widget\n        .querySelector(\".widget-content__text\")\n        .classList.add(`widget-content__text_width-${this.event.size}`);\n\n      this.widget.querySelector(\n        \".widget-content__text\"\n      ).innerText = this.event.description;\n    }\n  }\n\n  setHeaderData() {\n    this.widget.querySelector(\n      \".widget-header-about__title\"\n    ).innerText = this.event.title;\n\n    this.widget.querySelector(\n      \".widget-header__type\"\n    ).innerText = this.event.source;\n\n    this.widget.querySelector(\n      \".widget-header__date\"\n    ).innerText = this.event.time;\n\n    this.widget\n      .querySelector(\".widget-header-about__icon > use\")\n      .setAttribute(\"xlink:href\", `#${this.event.icon}`);\n\n    this.widget\n      .querySelector(\".widget-header-about__icon\")\n      .classList.add(`icon_${this.event.icon}`);\n  }\n\n  getDataTemplateType() {\n    const { data = {}, icon } = this.event;\n\n    if (data.type === \"graph\") {\n      return WIDGET_TYPES.STATS;\n    }\n\n    if (icon === \"cam\") {\n      return WIDGET_TYPES.CAMERA;\n    }\n\n    if (data.temperature) {\n      return WIDGET_TYPES.THERMAL;\n    }\n\n    if (data.albumcover) {\n      return WIDGET_TYPES.PLAYER;\n    }\n\n    if (data.buttons) {\n      return WIDGET_TYPES.QUESTIONS;\n    }\n\n    return WIDGET_TYPES.DEFAULT;\n  }\n\n  renderDataTemplate() {\n    const templateDataType = this.getDataTemplateType();\n    let dataContentBlock = null;\n\n    switch (templateDataType) {\n      case WIDGET_TYPES.STATS:\n        const statsWidget = new StatsWidget({\n          data: this.event.data\n        });\n\n        dataContentBlock = statsWidget.render();\n\n        break;\n\n      case WIDGET_TYPES.CAMERA:\n        const cameraWidget = new CameraWidget({\n          data: this.event.data\n        });\n\n        dataContentBlock = cameraWidget.render();\n\n        break;\n\n      case WIDGET_TYPES.PLAYER:\n        const playerWidget = new PlayerWidget({\n          data: this.event.data\n        });\n\n        dataContentBlock = playerWidget.render();\n\n        break;\n\n      case WIDGET_TYPES.QUESTIONS:\n        const questionsWidget = new QuestionsWidget({\n          data: this.event.data\n        });\n\n        dataContentBlock = questionsWidget.render();\n\n        break;\n\n      case WIDGET_TYPES.THERMAL:\n        const thermalWidget = new ThemalWidget({\n          data: this.event.data\n        });\n\n        dataContentBlock = thermalWidget.render();\n\n        break;\n    }\n\n    if (dataContentBlock) {\n      this.widget\n        .querySelector(\".widget-content\")\n        .appendChild(dataContentBlock);\n    }\n  }\n\n  render() {\n    this.widget = this.template.content\n      .querySelector(\".widget\")\n      .cloneNode(true);\n\n    this.widget.classList.add(`widget_size-${this.event.size}`);\n    this.widget.classList.add(`widget_type-${this.event.type}`);\n\n    this.setHeaderData();\n    this.setDescription();\n    this.renderDataTemplate();\n\n    this.container.appendChild(this.widget);\n  }\n}\n\nexport default Widget;","class ApplicationLayout {\n  constructor(selector) {\n    this.layout = document.querySelector(selector);\n  }\n\n  block() {\n    this.layout.classList.add(\"application_state-frozen\");\n    this.layout.classList.add(\"application_state-blured\");\n  }\n\n  unblock() {\n    this.layout.classList.remove(\"application_state-frozen\");\n    this.layout.classList.remove(\"application_state-blured\");\n  }\n}\n\nconst Layout = new ApplicationLayout(\"#application\");\n\nexport default Layout;\n","import layout from \"../layout/layout\";\nimport HeaderNavigation from \"../components/header/header\";\n\nimport IndexPage from \"./index.page\";\nimport VideocontrolPage from \"./videocontrol.page\";\n\nclass InitApplication {\n  constructor() {\n    this.currentPage = window.location.pathname;\n\n    this.init();\n  }\n\n  routing() {\n    switch (this.currentPage) {\n      case \"/\":\n        this.page = new IndexPage();\n        break;\n\n      case \"/videocontrol.html\":\n        this.page = new VideocontrolPage();\n        break;\n    }\n  }\n\n  init() {\n    this.headerNavigation = new HeaderNavigation({\n      selector: \"#header-menu\",\n      layout\n    });\n\n    this.routing();\n  }\n}\n\nnew InitApplication();","import Widget from \"../components/widget/widget\";\n\nclass IndexPage {\n  constructor() {\n    this.init();\n  }\n\n  renderDashboardWidgets(events) {\n    const dashboardWidgetsList = document.getElementById(\"dashboard-list\");\n\n    events.forEach(event => {\n      new Widget({\n        event,\n        container: dashboardWidgetsList\n      });\n    });\n  }\n\n  loadEvents() {\n    return fetch(\"http://localhost:8000/api/events\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        type: \"critical:info\",\n        offset: 0,\n        limit: 20\n      }),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    })\n      .then(response => response.json())\n      .then(result => result)\n      .catch(err => alert(err));\n  }\n\n  init() {\n    this.loadEvents().then(events => {\n      this.renderDashboardWidgets(events);\n    });\n  }\n}\n\nexport default IndexPage;","\nimport Videocontrol from \"../components/videocontrol/videocontrol\";\n\nclass VideoControlPage {\n  constructor() {\n    this.broadcasts = [\n      {\n        url:\n          \"http://localhost:9191/master?url=http%3A%2F%2Flocalhost%3A3102%2Fstreams%2Fsosed%2Fmaster.m3u8\"\n      },\n      {\n        url:\n          \"http://localhost:9191/master?url=http%3A%2F%2Flocalhost%3A3102%2Fstreams%2Fcat%2Fmaster.m3u8\"\n      },\n      {\n        url:\n          \"http://localhost:9191/master?url=http%3A%2F%2Flocalhost%3A3102%2Fstreams%2Fdog%2Fmaster.m3u8\"\n      },\n      {\n        url:\n          \"http://localhost:9191/master?url=http%3A%2F%2Flocalhost%3A3102%2Fstreams%2Fhall%2Fmaster.m3u8\"\n      }\n    ];\n\n    this.init();\n  }\n\n  init() {\n    const VideocontrolWidget = new Videocontrol({\n      broadcasts: this.broadcasts,\n      element: document.getElementById(\"vc-list\"),\n      elementShowAll: document.getElementById(\"vc-showall\")\n    });\n  }\n}\n\nexport default VideoControlPage;"],"sourceRoot":""}